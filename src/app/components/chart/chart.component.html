<div class="chart-wrapper" #chartWrapper>
  <div class="chart-controls">
    <div class="control-group">
      <label for="symbol">Symbol:</label>
      <select id="symbol" [(ngModel)]="selectedSymbol" (change)="onSymbolChange()">
        <option *ngFor="let sym of symbols" [value]="sym">{{ sym }}</option>
      </select>
    </div>

    <div class="control-group">
      <label for="interval">Zeitrahmen:</label>
      <select id="interval" [(ngModel)]="selectedInterval" (change)="onIntervalChange()">
        <option *ngFor="let int of intervals" [value]="int.value">{{ int.label }}</option>
      </select>
    </div>

    <div class="control-group">
      <label for="strategy">Strategie:</label>
      <select id="strategy" [(ngModel)]="selectedStrategy" (change)="onStrategyChange()">
        <option [value]="null">Keine Strategie</option>
        <option *ngFor="let strategy of strategies" [value]="strategy.id">
          {{ strategy.name }} ({{ strategy.symbol }})
        </option>
      </select>
    </div>

    <button class="btn-refresh" (click)="loadChartData()">Aktualisieren</button>

    <div class="live-indicator" *ngIf="isLiveUpdating">
      <span class="live-dot"></span>
      <span>Live</span>
    </div>
  </div>

  <div class="strategy-info" *ngIf="selectedStrategy">
    <div class="info-badge">
      <span class="label">Aktive Strategie:</span>
      <span class="value">{{ getStrategyName(selectedStrategy) }}</span>
    </div>
    <div class="indicator-legend">
      <div class="legend-item">
        <span class="color-box" style="background-color: #2196F3;"></span>
        <span>SMA 20</span>
      </div>
      <div class="legend-item">
        <span class="color-box" style="background-color: #FF9800;"></span>
        <span>SMA 50</span>
      </div>
      <div class="legend-item" *ngIf="hasRSIIndicator()">
        <span class="color-box" style="background-color: #9C27B0;"></span>
        <span>RSI (14)</span>
      </div>
    </div>
    <div class="signal-legend">
      <div class="legend-item">
        <span class="signal-marker buy">▲</span>
        <span>Buy Signal</span>
      </div>
      <div class="legend-item">
        <span class="signal-marker sell">▼</span>
        <span>Sell Signal</span>
      </div>
    </div>
  </div>

  <div class="chart-container" #chartContainer [class.with-rsi]="selectedStrategy && hasRSIIndicator()"></div>

  <div class="rsi-chart-wrapper" *ngIf="selectedStrategy && hasRSIIndicator()">
    <h2>RSI (14)</h2>
    <div class="rsi-container" #rsiContainer></div>
  </div>
</div>
